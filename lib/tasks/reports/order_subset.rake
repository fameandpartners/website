ORDER_NUMBERS = %w[
R138472075 R187478056 R853678420 R721308412 R012834743 R223541633 R371014507 R035286276
R706638144 R341664414 R184670462 R274855043 R685407284 R343275281 R380388737 R400067337
R441764452 R213662748 R837728828 R704517631 R456818787 R444571462 R488118461 R533448064
R028406083 R570052580 R656828127 R218821665 R552638612 R762008478 R405055052 R576760787
R422551642 R138850773 R473618176 R723780628 R468131415 R762256003 R274607103 R408534727
R801636650 R273414863 R016721326 R481547055 R828720586 R572177687 R872360732 R615766424
R374224533 R130022542 R824164584 R584615044 R286861037 R747236132 R480748203 R128261871
R303410660 R878265242 R703830566 R464163224 R122024658 R334806850 R350674712 R458180608
R652120754 R434862620 R830424823 R764437010 R255702533 R172113043 R563611130 R106076762
R366353528 R614183180 R840308622 R642707362 R262821130 R068741642 R883668884 R567382735
R621084524 R646661571 R025873178 R447611325 R408867020 R546323827 R514341356 R502208466
R477784421 R400124006 R405426008 R406857032 R407475307 R408366277 R40844480 R410177134
R415368717 R420207213 R423460725 R424810568 R427320731 R428086068 R428245686 R428636716
R433003282 R435476827 R436441247 R442358272 R443878325 R444035718 R444283280 R448244508
R448882665 R457223857 R458266103 R458268137 R355080754 R108631176 R012703604 R133507243
R853270088 R383410276 R581558221 R766773783 R238566407 R483271564 R617064428 R778574201
R705288243 R132044018 R701705860 R301341768 R686050578 R613564522 R635708354 R100376832
R232282824 R248073301 R511037064 R841068157 R572805005 R710607125 R571465580 R530226056
R343440615 R546677668 R833304830 R658244046 R648570203 R317245103 R886827332 R761164074
R834862136 R084685887 R765566872 R253148853 R645586457 R825308036 R623663453 R730623366
R434724227 R530701827 R548541513 R026622878 R562476354 R807075314 R301312047 R433573511
R457763022 R523712047 R130507527 R418620034 R604840064 R742438274 R511308834 R327625224
R820884087 R435713456 R605805602 R557654373 R283112814 R877058750 R862361556 R463722232
R841145056 R876065250 R263828763 R828806453 R787708582 R218677046 R101482467 R582563542
R303522883 R443686463 R243212113 R674075078 R582538516 R713163551 R500268708 R713467253
R080347401 R136505722 R505206805 R744676078 R478615422 R274825222 R707243624 R881477855
R327150213 R261188044 R331750455 R338801125 R603308341 R276220767 R454478573 R632142061
R810562653 R103163107 R543020714 R667058067 R830012331 R663251107 R547723303 R727605278
R836373074 R430551231 R255252376 R830447368 R153557026 R330276370 R070488141 R563436154
R726084183 R523867647 R771040031 R427531544 R306043482 R660431532 R583666710 R888556200
R174736303 R265037230 R254610606 R214152133 R463051048 R108038843 R116386110 R338786136
R137846363 R028001750 R424104845 R362704218 R364605582 R273818488 R320712037 R812446487
R578630461 R047040846 R236642871 R608215235 R507561758 R707501002 R037534525 R158876530
R468142567 R485047835 R384458581 R725402718 R386732823 R076642660 R125762232 R538740282
R881773273 R618456182 R766441703 R666274216 R012658567 R426324646 R186874210 R121562726
R105876244 R582237673 R767038553 R606123084 R272125371 R513477133 R712340170 R182627818
R073154880 R257607066 R426464237 R232887811 R307238581 R117506311 R708755404 R153806315
R367637450 R747133364 R388473804 R504618231 R854428774 R685517680 R812836241 R2272787664
R056444116 R178174171 R683733258 R485038233 R035667381 R067436715 R014385565 R882468621
R818230683 R321673576 R436556106 R537106577 R831562333 R843847231 R666726014 R444028440
R258367154 R314737630 R874121721 R701446844 R277358847 R106541474 R660127328 R548841752
R866615243 R222035437 R551103242 R871548125 R526236500 R067171604 R837308673 R366362131
R443613280 R010124276 R881872535 R307447764 R676681754 R880052658 R274263531 R631346713
R567753212 R502527712 R521385288 R266138717 R076556062 R562238187 R350785531 R541157157
R447224368 R270755438 R607776463 R186414548 R537717323 R223568600 R706103756 M363160
MANUAL Refund R001328547 R001565586 R001888250 R002847873 R005337288 R006282852 R018458221
R020685261 R021243881 R022035031 R022512106 R024071505 R025627267 R027851202 R028771883
R030130156 R032348407 R032404534 R033325143 R034145042 R034202226 R035200407 R035560428
R037325631 R040867718 R042170342 R042420414 R043850778 R046540663 R046864616 R057600168
R057600620 R063325245 R064281774 R074248586 R075832204 R081402524 R085115066 R104804584
R105503376 R107163250 R107166173 R112148112 R113250012 R117062303 R122371682 R122550176
R124450361 R128128324 R130067780 R130631517 R133787513 R135175753 R138621131 R147584871
R152112014 R155537681 R158431471 R166513837 R174308028 R176035820 R178281672 R178568407
R185114660 R186217127 R188641414 R201831633 R201852371 R210326541 R210646647 R213507775
R218466306 R221521415 R222710302 R225156771 R227278764 R228257345 R230420574 R230831332
R231287233 R234873018 R236202883 R2363071416 R240521612 R242441206 R247263228
]

namespace :reports do
  desc 'subset_of_orders'
  task :subset_of_orders => :environment do

    order_numbers = ORDER_NUMBERS

    orders = Spree::Order.where(number: order_numbers)

    generator = ::Orders::LineItemCsvGenerator.new(orders)

    file_path = File.join(Rails.root, 'tmp', generator.filename)

    File.write(file_path, generator.to_csv)

    puts "wrote #{file_path}"
  end
end
