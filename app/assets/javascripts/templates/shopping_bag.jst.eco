<div class="row row-no-gutter no-spacing-fluid-cols-mobile">
  <div class="close-cart-layer close-cart col-md-7 col-lg-8 hidden-xs hidden-sm"></div>
  <div class="cart-wrapper col-lg-4 col-md-5 col-xs-12">
    <div class="row">
      <div class="cart--top text-center col-xs-12">
        <div class="pull-left close-cart text-uppercase cta-icon-text">
          <span class="icon icon-arrow-left"></span>
          Back
        </div>
          <form method="get" action="<%= urlWithSitePrefix('/checkout') %>">
            <div class="pull-right">
              <span class="cart-checkout">
              <% if @cart.products.length: %>
                <button type="submit" class="cta-icon-text btn btn-black">CHECKOUT <i class="icon icon-arrow-right"></i></button>
              <% else: %>
                <button type="submit" class="cta-icon-text btn btn-black" disabled="disabled">CHECKOUT <i class="icon icon-arrow-right"></i></button>
              <% end %>
              </span>
            </div>
          </form>
        <div class="cart-title">
          <h2>Your Bag</h2>
          <span class="amount"><%= @cart.display_total %></span>
        </div>
      </div>
    </div>

    <div class="free-shipping-disclaimer">
      <div class="row">
        <div class="col-xs-12">
          <p>
            <% if getSiteVersionPrefix() == '/au': %>
              <span class="link-underline-lighter">Free shipping</span> to Australia within 7 - 10 days
            <% else: %>
              <span class="link-underline-lighter">Free shipping</span> to USA, Canada and the UK within 7 - 10 business days
            <% end %>
          </p>
          <p>
            <span class="link-underline-lighter">Easy returns</span> within 30 days
          </p>
        </div>
      </div>
    </div>

    <% if @cart.products.length: %>
    <div class="cart-items">
      <% for product in @cart.products: %>
      <div class="row cart-item" data-id="<%= product.line_item_id %>">
        <div class="cart-item-image-holder col-md-5">
          <a href="<%= product.path %>">
            <% if product.name != "Gift" : %>
              <img class="img-responsive cart-item-image" src="<%= product.image.large %>" />

                <% if product.making_options.length: %>
                  <div class="ribbon-wrapper express-making">
                    <div class="ribbon-txt">
                      Make it express
                    </div>
                  </div>
                <% end %>

            <% end %>
          </a>
        </div>
        <div class="cart-item-info col-md-7">
          <a class="pull-right remove-product" href="javascript:;">
            <span class="icon btn-close"></span>
          </a>
          <div class="heading txt-truncate-1">
            <% if product.name != "Gift" : %>
            <a class="cart-item-title" href="<%= product.path %>"><%= product.name %></a>
            <% else :%>
            <a class="cart-item-title" href="#"><%= product.name %></a>
            <% end %>
          </div>
          <div class="cart-item-price"><%= product.price.display_price %></div>
          <dl class="cart-item-description">
            <% if product.size != null : %>
            <dd>Size: <span><%= product.size.presentation %>, </span></dd>
            <% end %>
            <dd>Color: <span class="color"><%= product.color.name %></span></dd>
            <dd>Skirt Length: <span><%= product.height %></span></dd>
            <% for customization in product.customizations: %>
            <dd><%= customization.name %> <%= customization.display_price %></dd>
            <% end %>

            <%# Making options stands for Fast Making %>
            <% for making_option in product.making_options: %>
              <dd><%= making_option.name %> <%= making_option.display_price %></dd>
            <% end %>
          </dl>
        </div>
      </div>
      <% end %>
    </div>
    <% else: %>
    <div class="row cart-is-empty">
      <div class="col-xs-12">
        <h3 class="heading">Your bag is empty</h3>
        <a href="<%= urlWithSitePrefix('/dresses/new-this-week') %>" class="link-underline-lighter cta-when-empty">Find some inspiration with whatâ€™s new this week</a>
      </div>
    </div>
    <% end %>

    <div class="cart-footer">
      <div class="row">
        <div class="col-xs-12">
          <div class="cart-total">
            <p>
              Shipping <span class="value"><%= @cart.display_shipment_total %></span>
            </p>
            <p>
              <% # TODO: this is just a workaround due to Spree's limitations. We should compare numbers, not strings. %>
              <% if @cart.display_promotion_total != "$0.00": %>
              Promotion (<span class="promocode-name"><%= @cart.promocode %></span>)<span class="value"><%= @cart.display_promotion_total %></span>
              <% end %>
            </p>
            <% if @cart.taxes: %>
              <% for tax in @cart.taxes: %>
                <p>
                  <%= tax.label %>
                  <span class="value"><%= tax.display_tax_total %></span>
                </p>
              <% end %>
            <% end %>
            <p class="order-total">
              Order Total <span class="value"><%= @cart.display_total %></span>
            </p>
          </div>
          <div class="cart--call-to-actions">
            <form method="get" action="<%= urlWithSitePrefix('/checkout') %>">
              <div>
                <% if @cart.products.length: %>
                  <input type="submit" value="Continue to payment" class="text-uppercase btn btn-black btn-block">
                <% else: %>
                  <input type="submit" value="Continue to payment" class="text-uppercase btn btn-black btn-block"  disabled="disabled">
                <% end %>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="shopping-bag-order-number">
      <div class="row">
        <div class="col-xs-12">
          Your Order Number: <%= @cart.order_number %>
        </div>
      </div>
    </div>
  </div>
</div>
