$quiz_box = $('.quiz-box');
$progress_bar = $quiz_box.find('.progress-bar');
$question = $quiz_box.find('#question-<%= @question.id %>');

$quiz_box.find('.film').animate({ left: '-' + $question.position().left });
$quiz_box.find('.next a').unbind('click');
$quiz_box.find('.next a').text('Next question').click(function(event){
  var $link = $(event.target);
  $link.unbind('click');
  $link.text('Processing...');
  event.preventDefault();
  $question.find('form').submit();

  track.quizClickedNext('<%=j analytics_label(:question, @question, @position) %>');
});

$quiz_box.find('.prev a').unbind('click');
<%- unless (index = @quiz.questions.index(@question)).eql?(0) -%>
  $quiz_box.find('.prev a').click(function(event){
    event.preventDefault();
    $.getScript('/quiz/questions/<%= @quiz.questions[index - 1].id %>');
  });
<%- end -%>

$progress_bar.find('.filler').animate({ width: '<%= @progress %>%' });
$progress_bar.find('.tooltip').text('<%= @progress %>%');

$('.questions-count .inline.current').text('<%= @position %>');

<% if @position.to_i == 2 %>
  track.conversion('quiz_step1');
<% elsif @position.to_i == 3 %>
  track.conversion('quiz_step2');
<% end %>
